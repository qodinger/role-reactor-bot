# =============================================================================
# Role Reactor Bot Configuration
# =============================================================================
# Copy this file to .env and fill in your values
# For VPS deployment: cp env.example .env && nano .env

# =============================================================================
# DISCORD CONFIGURATION (REQUIRED)
# =============================================================================

# Your Discord Bot Token [REQUIRED]
# Get this from https://discord.com/developers/applications
DISCORD_TOKEN=your_bot_token_here

# Your Discord Application Client ID [REQUIRED]
# Found in your Discord application's General Information page
CLIENT_ID=your_client_id_here

# Target Guild ID (Optional - for development)
# If set, commands will only be deployed to this guild (faster for development)
GUILD_ID=your_guild_id_here

# Developer IDs [OPTIONAL]
# Comma-separated list of Discord user IDs who can use developer commands
# Developer commands: /health, /performance, /storage
# Example: DEVELOPERS=123456789012345678,987654321098765432
# Get your user ID by enabling Developer Mode in Discord and right-clicking your name
DEVELOPERS=

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# MongoDB Connection URI [OPTIONAL]
# The bot uses a hybrid storage system: MongoDB + Local JSON files
# If MongoDB is unavailable, the bot continues with local storage
# 
# Examples:
# - Atlas (Recommended for VPS): mongodb+srv://username:password@cluster.mongodb.net/role-reactor-bot?retryWrites=true&w=majority
# - Local MongoDB: mongodb://localhost:27017
# - Docker: mongodb://mongodb:27017
# - Leave empty for local files only (no database)
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/role-reactor-bot?retryWrites=true&w=majority

# MongoDB Database Name [OPTIONAL]
# Default: role-reactor-bot
MONGODB_DB=role-reactor-bot

# MongoDB Connection Pool Settings [OPTIONAL - ADVANCED]
# Lower minPoolSize = lower compute usage
# Default: minPoolSize=2, maxPoolSize=20
# Increase minPoolSize if you have high concurrent traffic
# Example: MONGODB_MIN_POOL_SIZE=2
# Example: MONGODB_MAX_POOL_SIZE=20
# MONGODB_MIN_POOL_SIZE=2
# MONGODB_MAX_POOL_SIZE=20

# =============================================================================
# STORAGE CONFIGURATION
# =============================================================================

# Local Data Directory [OPTIONAL]
# Directory for local JSON file storage (backup/fallback)
# Default: ./data
LOCAL_DATA_DIR=./data

# Sync Interval (minutes) [OPTIONAL]
# How often to sync local files with database
# Default: 5 minutes
SYNC_INTERVAL=5

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

# Log Level [OPTIONAL]
# Options: ERROR, WARN, INFO, DEBUG, SUCCESS
# Default: INFO (use DEBUG for troubleshooting)
LOG_LEVEL=INFO

# Log File Path [OPTIONAL]
# If set, logs will be written to this file in addition to console
# Recommended for VPS: ./logs/bot.log
LOG_FILE=./logs/bot.log

# Enable Console Logging [OPTIONAL]
# Set to 'false' to disable console logging
# Default: true (keep true for VPS monitoring)
LOG_CONSOLE=true

# =============================================================================
# AI FEATURES (OPTIONAL)
# =============================================================================
# 
# AI features include:
# - /ask: Chat with the AI about the bot and server
# - /imagine: Generate images
# - /avatar: Generate avatar images
# 
# Provider selection is configured in src/config/config.js using enabled flags
# See the AI MODEL CONFIGURATION section below for details
#
# Bot Website URL [OPTIONAL]
# Your bot's website URL for API identification
# Used for API usage tracking and support
BOT_WEBSITE_URL=https://github.com/your-repo/role-reactor-bot

# Bot Name [OPTIONAL]
# Your bot's name for API identification
# Used for API usage tracking and support
BOT_NAME=Role Reactor Bot

# =============================================================================
# KO-FI WEBHOOK INTEGRATION (OPTIONAL)
# =============================================================================

# Ko-fi Webhook Verification Token [OPTIONAL]
# Get this from your Ko-fi webhook settings
# Used to verify that webhook requests are from legitimate Ko-fi servers
# Example: KOFI_WEBHOOK_TOKEN=your_verification_token_here
KOFI_WEBHOOK_TOKEN=your_verification_token_here

# =============================================================================
# BUY ME A COFFEE WEBHOOK INTEGRATION (OPTIONAL)
# =============================================================================

# Note: Buy Me a Coffee webhooks do not use signature verification
# Webhooks are authenticated by the webhook URL being secret

# =============================================================================
# CRYPTOCURRENCY PAYMENT INTEGRATION (OPTIONAL)
# =============================================================================

# Coinbase Commerce API Key [OPTIONAL]
# Get this from https://commerce.coinbase.com
# Required for cryptocurrency payments
# Example: COINBASE_API_KEY=your_api_key_here
COINBASE_API_KEY=your_api_key_here

# Coinbase Commerce Webhook Secret [OPTIONAL]
# Get this from your Coinbase Commerce webhook settings
# Used to verify that webhook requests are from legitimate Coinbase servers
# Example: COINBASE_WEBHOOK_SECRET=your_webhook_secret_here
COINBASE_WEBHOOK_SECRET=your_webhook_secret_here

# Enable Cryptocurrency Payments [OPTIONAL]
# Set to 'true' to enable cryptocurrency payments
# Default: false
COINBASE_ENABLED=false

# =============================================================================
# WEBSITE AUTHENTICATION (OPTIONAL)
# =============================================================================

# Discord OAuth2 Client ID [OPTIONAL]
# Get this from https://discord.com/developers/applications
# Required for website Discord login
# Example: DISCORD_CLIENT_ID=your_client_id_here
DISCORD_CLIENT_ID=your_client_id_here

# Discord OAuth2 Client Secret [OPTIONAL]
# Get this from https://discord.com/developers/applications
# Required for website Discord login
# Example: DISCORD_CLIENT_SECRET=your_client_secret_here
DISCORD_CLIENT_SECRET=your_client_secret_here

# Bot Website URL [OPTIONAL]
# Your website URL for OAuth redirects
# If set, DISCORD_REDIRECT_URI will be automatically constructed as: ${BOT_URL}/auth/discord/callback
# Example: BOT_URL=https://your-website.com
BOT_URL=https://your-website.com

# Discord OAuth2 Redirect URI [OPTIONAL]
# Your website's OAuth callback URL
# If not set, will be automatically constructed from BOT_URL: ${BOT_URL}/auth/discord/callback
# Only set this if your redirect URI is different from the default
# Example: DISCORD_REDIRECT_URI=https://your-website.com/auth/discord/callback
# DISCORD_REDIRECT_URI=https://your-website.com/auth/discord/callback

# Session Secret [OPTIONAL]
# Random string for session encryption
# Generate with: openssl rand -base64 32
# Example: SESSION_SECRET=your_random_secret_here
SESSION_SECRET=your_random_secret_here

# Serve Static Files [OPTIONAL]
# Set to 'true' to serve website files from public/ directory
# Default: false
SERVE_STATIC=false

# =============================================================================
# MONITORING & HEALTH CHECKS (OPTIONAL)
# =============================================================================

# Health Check Server Port [OPTIONAL]
# Port for the health check HTTP server
# Default: 3001 (will auto-increment if port is busy)
# HEALTH_PORT=3001

# =============================================================================
# DEPLOYMENT NOTES
# =============================================================================
# 
# 1. Never commit your .env file to version control
# 2. Keep your bot token secret and secure
# 3. Use different tokens for development and production
# 4. Test your configuration with a development server first
# 5. Monitor your bot's logs for any issues
# 6. Set LOG_LEVEL to DEBUG for detailed debugging information
# 7. Use LOG_FILE for persistent logging in production
# 8. For VPS: Set NODE_ENV=production in your .env file
# 
# =============================================================================
# VPS DEPLOYMENT
# =============================================================================
# 
# For VPS deployment, recommended settings:
# - MONGODB_URI: Use MongoDB Atlas free tier (mongodb+srv://...)
# - NODE_ENV: production
# - LOG_LEVEL: INFO or WARN
# - LOG_FILE: ./logs/bot.log
# - DEVELOPERS: Set to your Discord user ID for developer commands
# 
# Cost-effective setup:
# - VPS: $5-10/month (DigitalOcean, Linode, Vultr)
# - MongoDB Atlas: Free tier (512MB) or $9/month
# - Total: $5-19/month depending on database choice
# 
# Quick VPS setup:
# 1. cp env.example .env
# 2. nano .env (fill in your values)
# 3. ./scripts/deploy.sh
# 
# =============================================================================
# AI MODEL CONFIGURATION
# =============================================================================
#
# Provider selection is configured in src/config/config.js, not via environment variables
# Edit src/config/config.js and set enabled: true/false for each provider
# Providers are checked in order - first enabled provider is used automatically
#
# IMPORTANT: At least one provider must be enabled for AI features to work
# - For /ask (chat): Requires a text-capable provider (self-hosted Ollama recommended)
# - For /imagine and /avatar: Requires an image-capable provider
# If all providers are disabled, all AI commands will be disabled
#
# OpenRouter API Key [OPTIONAL]
# Get from https://openrouter.ai/keys
# Required if OpenRouter provider is enabled in config.js
# Text/Chat Models: GPT-4o-mini (openai/gpt-4o-mini) - Recommended for /ask command
# Image Models: Google Gemini 3 Pro Image Preview (default)
# Cost: ~$0.00046 per request (very affordable!)
OPENROUTER_API_KEY=your_openrouter_api_key_here

# OpenAI API Key [OPTIONAL]
# Get from https://platform.openai.com/api-keys
# Required if OpenAI provider is enabled in config.js
# Models: DALL-E 3
OPENAI_API_KEY=your_openai_api_key_here

# Stability AI API Key [OPTIONAL]
# Get from https://platform.stability.ai/account/keys
# Required if Stability AI provider is enabled in config.js
# Models: Stable Diffusion 3.5 (sd3.5-flash, sd3.5-medium, sd3.5-large, etc.)
# Provides access to Stable Diffusion 3.5 models (cheaper than OpenAI/OpenRouter)
STABILITY_API_KEY=your_stability_api_key_here

# Self-Hosted AI API URL [OPTIONAL]
# URL for your local AI instance (Ollama, Automatic1111, etc.)
# Required if self-hosted provider is enabled in config.js
# 
# For Ollama (text/chat models):
# - Default: http://127.0.0.1:11434
# - Supports OpenAI-compatible API at /v1/chat/completions
# - Also supports native Ollama API at /api/chat
# Example: SELF_HOSTED_API_URL=http://127.0.0.1:11434
#
# For Automatic1111 (image generation):
# - Default: http://127.0.0.1:7860
# - For remote access: http://your-server-ip:7860
# Example: SELF_HOSTED_API_URL=http://127.0.0.1:7860
SELF_HOSTED_API_URL=http://127.0.0.1:11434

# Self-Hosted AI API Key [OPTIONAL]
# Optional authentication key for your self-hosted API
# Only needed if you've configured authentication
# Leave empty if no authentication is required
# Example: SELF_HOSTED_API_KEY=your_api_key_here
SELF_HOSTED_API_KEY=

# Self-Hosted Text Model [OPTIONAL]
# Model name for text/chat generation (Ollama models)
# Default: llama3.1:8b (recommended minimum for structured JSON output)
# Popular models: llama3.1:8b, llama3.2, mistral:7b, qwen2.5:7b
# Note: llama3.2 (3B) is too small for structured JSON output - use llama3.1:8b minimum
# Example: SELF_HOSTED_TEXT_MODEL=llama3.1:8b
SELF_HOSTED_TEXT_MODEL=llama3.1:8b

# =============================================================================
# AI RATE LIMITING CONFIGURATION (OPTIONAL)
# =============================================================================
#
# These settings control how many AI requests users can make to prevent abuse
# and manage costs. For chat/conversational AI, higher limits are recommended.
#
# AI User Rate Limit [OPTIONAL]
# Maximum number of AI requests per user per time window
# Default: 50 requests per 1 minute (very generous for chat/conversational AI)
# For self-hosted models (Ollama), higher limits are safe since there are no API costs
# For paid APIs (OpenAI, Stability), lower values (10-20) help manage costs
# Example: AI_USER_RATE_LIMIT=50
AI_USER_RATE_LIMIT=50

# AI User Rate Limit Window [OPTIONAL]
# Time window in milliseconds for rate limiting
# Default: 60000 (1 minute) - shorter window allows more natural conversations
# Longer windows (300000 = 5 minutes) are more restrictive but prevent burst usage
# Example: AI_USER_RATE_LIMIT_WINDOW=60000
AI_USER_RATE_LIMIT_WINDOW=60000

# AI Max Concurrent Requests [OPTIONAL]
# Maximum number of simultaneous AI requests across all users
# Default: 100 (good for high-traffic servers)
# For self-hosted Ollama: Can be increased to 200-500+ depending on server CPU/RAM
# For paid APIs (OpenAI, Stability): Keep lower (50-100) to manage costs
# Higher values = more simultaneous requests but more server resources used
# 
# PERFORMANCE NOTE: Higher concurrency = faster processing but may slow individual responses
# If many users use /ask simultaneously:
# - Requests over this limit will be queued (wait time added)
# - Ollama itself has limits (check Ollama's num_parallel setting)
# - Each request uses CPU/RAM, so too many = slower individual responses
# Recommended: Start with 100, increase if server can handle it
# Example: AI_MAX_CONCURRENT=100
AI_MAX_CONCURRENT=100

# AI Use Long-Term Memory [OPTIONAL]
# Enable persistent conversation storage (survives bot restarts)
# Default: false (disabled)
# Set to 'true' to enable persistent conversation history across bot restarts
# Note: Conversations still work without this, but history resets on bot restart
# Example: AI_USE_LONG_TERM_MEMORY=false
AI_USE_LONG_TERM_MEMORY=false

# AI Conversation Storage Type [OPTIONAL]
# Where to store conversation history when AI_USE_LONG_TERM_MEMORY=true
# Options: "file" (default), "mongodb", "memory" (no persistence)
# Default: file (saves to local JSON files)
# Recommended: "file" for local storage without database dependency
# Note: "file" storage works even without MongoDB connection
# Set to "mongodb" if you need database features (indexing, queries, etc.)
# Example: AI_CONVERSATION_STORAGE_TYPE=file
AI_CONVERSATION_STORAGE_TYPE=file

# AI Image Jobs Storage Type [OPTIONAL]
# Where to store image generation job history (avatar_jobs, imagine_jobs)
# Options: "file" (default), "mongodb"
# Default: file (saves to local JSON files: data/avatar_jobs.json, data/imagine_jobs.json)
# Recommended: "file" for local storage without database dependency
# Note: "file" storage works even without MongoDB connection
# Set to "mongodb" if you need database features (indexing, queries, etc.)
# Example: AI_IMAGE_JOBS_STORAGE_TYPE=file
AI_IMAGE_JOBS_STORAGE_TYPE=file

# AI Image Jobs Retention Days [OPTIONAL]
# How many days to keep image generation job history before automatic cleanup
# Default: 7 days
# Note: This is for debugging and support purposes. Data is automatically deleted after this period.
# Users can request immediate deletion of their data if needed.
# Set to 0 or negative (e.g., -1) to DISABLE automatic deletion (data stored indefinitely)
# Set to a positive number (e.g., 7) to enable automatic cleanup after that many days
# Example: AI_IMAGE_JOBS_RETENTION_DAYS=7 (or 0 to disable auto-deletion)
AI_IMAGE_JOBS_RETENTION_DAYS=7

# AI Conversation History Length [OPTIONAL]
# Number of previous messages to include in conversation context
# Default: 20 messages (increased for better LTM)
# Higher values = better context but more tokens used
# Recommended: 20-50 for LTM, 10-20 for in-memory only
# Example: AI_CONVERSATION_HISTORY_LENGTH=20
AI_CONVERSATION_HISTORY_LENGTH=20

# AI Conversation Timeout [OPTIONAL]
# Time in milliseconds before a conversation is considered inactive
# Default: 604800000 (7 days) for LTM, 900000 (15 minutes) for in-memory
# With LTM: Can be much longer (days/weeks) since it's stored in database
# Without LTM: Keep shorter (15-60 minutes) to save memory
# Example: AI_CONVERSATION_TIMEOUT=604800000 (7 days)
AI_CONVERSATION_TIMEOUT=604800000

# AI Max Conversations [OPTIONAL]
# Maximum number of active conversations to keep in memory
# Default: 1000
# Higher values = more memory usage but better for many users
# Example: AI_MAX_CONVERSATIONS=1000
AI_MAX_CONVERSATIONS=1000

#
# To configure providers, edit src/config/config.js:
# - Set enabled: true to enable a provider
# - Set enabled: false to disable a provider
# - Providers are checked in order (selfhosted → stability → openrouter → openai)
# - First enabled provider is used automatically
# - If all providers are disabled, AI features are completely disabled
#
# Self-Hosted Setup (Recommended for /ask chat):
# - For text/chat (/ask): Install Ollama (https://ollama.ai)
#   - Run: ollama pull llama3.2 (or your preferred model)
#   - Ollama runs on http://127.0.0.1:11434 by default
#   - Free to run, no API costs
# - For images (/imagine, /avatar): Install Automatic1111 WebUI
#   - Launch with --api flag to enable API access
#   - Free to run (only uses your local hardware)
# - Best for: Cost savings, privacy, high-volume usage

# =============================================================================
# HYBRID STORAGE SYSTEM
# =============================================================================
# 
# Your bot uses a hybrid storage system:
# - Primary: MongoDB (cloud or local)
# - Backup: Local JSON files in ./data directory
# - Fallback: Bot continues working even if database is down
# - Sync: Data automatically syncs between storage systems
# 
# Benefits:
# - No data loss if database is unavailable
# - Works offline with local files
# - Professional database features when available
# - Cost-effective with free MongoDB Atlas tier
# 
# =============================================================================
# MONGODB ATLAS COST OPTIMIZATION
# =============================================================================
# 
# For MongoDB Atlas Flex tier (pay-as-you-go), here are optimization tips:
# 
# 1. USE FILE STORAGE FOR AI CONVERSATIONS
#    - Set AI_USE_LONG_TERM_MEMORY=true AND AI_CONVERSATION_STORAGE_TYPE=file
#    - Stores conversations in local JSON files instead of MongoDB
#    - Conversations persist across bot restarts (same as MongoDB)
#    - Works even without MongoDB connection
# 
# 2. DISABLE AI LONG-TERM MEMORY (Alternative)
#    - Set AI_USE_LONG_TERM_MEMORY=false (default)
#    - Reduces MongoDB operations
#    - Conversations still work, but history resets on bot restart
# 
# 3. OPTIMIZE CONNECTION POOL
#    - Lower minPoolSize = lower compute usage
#    - Default: minPoolSize=2 (optimized)
#    - Increase only if you have high concurrent traffic
#    - Set via MONGODB_MIN_POOL_SIZE and MONGODB_MAX_POOL_SIZE
# 
# 4. MONITOR USAGE
#    - Check MongoDB Atlas dashboard for actual usage
#    - Set up billing alerts to avoid surprises
#    - Review which operations cost the most
# 
# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================
# 
# Before deploying to VPS, ensure you have:
# ✅ Discord Bot Token (from Discord Developer Portal)
# ✅ Discord Client ID (from Discord Developer Portal)
# ✅ MongoDB Atlas account (free tier recommended)
# ✅ VPS provider account (DigitalOcean, Linode, Vultr)
# ✅ Your Discord user ID (for DEVELOPERS)
# ✅ Discord server ID (for GUILD_ID, optional)
# 
# Required .env values for production:
# ✅ DISCORD_TOKEN=your_actual_bot_token
# ✅ CLIENT_ID=your_actual_client_id
# ✅ MONGODB_URI=your_mongodb_atlas_connection_string
# ✅ NODE_ENV=production
# ✅ LOG_FILE=./logs/bot.log
# ✅ DEVELOPERS=your_discord_user_id 